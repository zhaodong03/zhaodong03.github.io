<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Convolution and Hybrid Images | Zhaodong Kang</title> <meta name="author" content="Zhaodong Kang"/> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "/> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://zhaodong03.github.io/projects/Convultion/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Zhaodong </span>Kang</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/travels/">travels</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Convolution and Hybrid Images</h1> <p class="post-description"></p> </header> <article> <h1 id="table-of-contents">Table of Contents</h1> <ul> <li><a href="#table-of-contents">Table of Contents</a></li> <li> <a href="#convolution-and-hybrid-images">Convolution and Hybrid Images</a> <ul> <li><a href="#overview">Overview</a></li> <li> <a href="#implement-convolution-with-numpy">Implement Convolution with NumPy</a> <ul> <li><a href="#gaussian-kernels">Gaussian Kernels</a></li> <li><a href="#convolution">Convolution</a></li> <li><a href="#hybrid-images">Hybrid Images</a></li> </ul> </li> <li><a href="#frequency-domain">Frequency Domain</a></li> <li><a href="#frequency-domain-convolutions">Frequency Domain Convolutions</a></li> <li> <a href="#frequency-domain-deconvolutions">Frequency Domain Deconvolutions</a> <ul> <li><a href="#limitation-of-deconvolutions">Limitation of Deconvolutions</a></li> </ul> </li> </ul> </li> </ul> <h1 id="convolution-and-hybrid-images">Convolution and Hybrid Images</h1> <h2 id="overview">Overview</h2> <p>To write an image filtering function and use it to create hybrid image based on <a href="http://olivalab.mit.edu/publications/OlivaTorralb_Hybrid_Siggraph06.pdf" target="_blank" rel="noopener noreferrer">paper</a>. Hybrid images are static images that change in interpretation as a function of the viewing distance. To create a hybrid image, I need to blend the high frequency portion of one image with the low-frequency portion of another</p> <h2 id="implement-convolution-with-numpy">Implement Convolution with NumPy</h2> <h3 id="gaussian-kernels">Gaussian Kernels</h3> <p>Gaussian filters are generally used to blur the images. In this step, I implemented the Gaussian kernels as shown below.<br> <img src="/assets/img/cv/2dGaussian.png" width="40%" height="40%"></p> <p>After applying this Gaussain filter to an image, it blurs this image <img src="/assets/img/cv/after_2dGaussian.png" width="100%"></p> <h3 id="convolution">Convolution</h3> <p>Convolution (or filtering) is a fundamental image processing tool. In this section, I implemented <code class="language-plaintext highlighter-rouge">my_conv2d_numpy()</code> based on the equation</p> \[h[m,n]=\sum f[k,l]I[m+k,n+l]\] <p>where <code class="language-plaintext highlighter-rouge">f=filter (size k x l)I = image (size m x n)</code>, In <code class="language-plaintext highlighter-rouge">my_conv2d_numpy()</code>, I firstly do a padding for the input image according to the the <code class="language-plaintext highlighter-rouge">filter.shape[0]//2</code> and <code class="language-plaintext highlighter-rouge">filter.shape[1]//2</code> to ensure the size of the image would not change after filtering. Then, I use nested for loop to do the element-wise multiplication between the filter and image. Then, take the sum of the multiplication as the result for the value in that index</p> <p>Below, there are some exmaple of differents kernels <br></p> <table> <thead> <tr> <th style="text-align: center"><img width="385"></th> <th style="text-align: center"><img width="385"></th> </tr> </thead> <tbody> <tr> <td style="text-align: center"><img src="/assets/img/cv/identity.png" width="80%"></td> <td style="text-align: center"><img src="/assets/img/cv/box.png" width="80%"></td> </tr> <tr> <td style="text-align: center">Identity Filter</td> <td style="text-align: center">Box Filter</td> </tr> <tr> <td style="text-align: center"><img src="/assets/img/cv/sobel.png" width="80%"></td> <td style="text-align: center"><img src="/assets/img/cv/discrete.png" width="80%"></td> </tr> <tr> <td style="text-align: center">Sobel Filter</td> <td style="text-align: center">Discrete Laplacian filter Filter</td> </tr> </tbody> </table> <h3 id="hybrid-images">Hybrid Images</h3> <p>Hybrid image (images give you different view when the distance changes) is the sum of a low-pass filtered version of one image and a high-pass filtered version of another image. To get the hybrid image, I do the following three steps</p> <ul> <li>Step 1: Get the low frequencies of image1 Using <code class="language-plaintext highlighter-rouge">my_conv2d_numpy(image1, filter) </code> </li> <li>Step 2: Get the high frequencies of image2 by subtracting the low frequencies from the original images</li> <li>Step 3: Get the hybrid image by add the low frequencies of image 1 and the high frequencies of image 2 (Note: we need to clip the final image to make sure that the value is in the proper range [0,1], using the <code class="language-plaintext highlighter-rouge">numpy.clip()</code> )</li> </ul> <p>Below are some examples: <img src="/assets/img/cv/hybrid_image_scales.jpg" width="100%"></p> <p><img src="/assets/img/cv/hybrid_image_scales_2.jpg" width="100%"></p> <p><img src="/assets/img/cv/hybrid_image_scales_3.jpg" width="100%"></p> <p><img src="/assets/img/cv/hybrid_image_scales_4.jpg" width="100%"></p> <p><img src="/assets/img/cv/hybrid_image_scales_5.jpg" width="100%"></p> <h2 id="frequency-domain">Frequency Domain</h2> <h2 id="frequency-domain-convolutions">Frequency Domain Convolutions</h2> <p>The Fourier transform of the convolution of two functions is the product of their Fourier transforms, and convolution in spatial domain is equivalent to multiplication in frequency domain. Therefore, we could do the convolution in the spatial domain.</p> <p>I have the orgial image and kernal shown below in Spatial and Frequence Domain seperately. <img src="/assets/img/cv/dog_frequence.png" width="100%"></p> <p><img src="/assets/img/cv/2dGaussian_frequence.png" width="100%"></p> <p>After the multiplication, I get the following result <img src="/assets/img/cv/dog2_frequence.png" width="100%"></p> <h2 id="frequency-domain-deconvolutions">Frequency Domain Deconvolutions</h2> <p>The Convolution Theorem refers the convolution in spatial domain is equivalent to the multiplication in frequency domain. With that idea, when comes to the invert the convolution, we could think about the division in the frequency domain. This idea leads to the deconvolution.</p> <p>For the above example, after the frequency domain division, we get the following the result <img src="/assets/img/cv/dog3_frequence.png" width="100%"></p> <h3 id="limitation-of-deconvolutions">Limitation of Deconvolutions</h3> <p>There are two factors that the deconvalutions mostly does not work in real world</p> <ul> <li>First factor is that in the real world, we mostly do not know the filter</li> <li>The second factor is that for some filter (like zero filter), it is almost impossible to do deconvolution</li> </ul> <p>Also, the deconvutions are very sensitive to noise.</p> <p>Here is a example, provided the following image with its kernel <img src="/assets/img/cv/mystery_example.png" width="100%"></p> <p><img src="/assets/img/cv/mystery_img.png" width="100%"></p> <p><img src="/assets/img/cv/mystery_kernal.png" width="100%"></p> <p>We could get the good deconvultion by doing the frequency domain division, shown below <img src="/assets/img/cv/deconv.png" width="100%"></p> <p>However, if we add the salt and pepper noise, we could only get this <img src="/assets/img/cv/deconv_noise.png" width="100%"></p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Zhaodong Kang. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="noopener noreferrer">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>